# Day 7

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/26a9b8e4-2604-43a2-930d-97e83a755f7e)

A log file is like a digital trail of what’s happening behind the scenes in a computer or software application. It records important events, actions, errors, or information as they happen. It helps diagnose problems, monitor performance, and record what a program or application is doing. For clarity, let’s look at a quick example.

## Day 7 Tasks:

### 1. How many unique IP addresses are connected to the proxy server?

Use the below command

`cut -d ‘ ‘ -f2 access.log | sort | uniq -c | sort -n | wc -l`

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/06f035ce-ee9b-4194-a8b8-10023836cd34)


Ans: ` 9`

### 2. How many unique domains were accessed by all workstations?

`cut -d ‘ ‘ -f3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n | wc -l`

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/76e59833-1b3f-46e7-b4f6-0e13da36bc60)


Ans: `111`

### 3. What status code is generated by the HTTP requests to the least accessed domain?

Search the domain which is least accessed by using the below command

`cut -d ‘ ‘ -f3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n`

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/9bb16fa4-f599-4ac3-9fcf-b3936a0956d1)


Ans: `503`

### 4. Based on the high count of connection attempts, what is the name of the suspicious domain?

You can find that the below domain has thm as Top level domain

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/ac2c6ca3-e788-4880-b776-59d944dca531)


Ans: `frostlings.bigbadstash.thm`

### 5. What is the source IP of the workstation that accessed the malicious domain?

`cut -d ‘ ‘ -f2,3 access.log | cut -d ‘:’ -f1 | sort | uniq -c | sort -n | tail -1`

![image](https://github.com/W4W1R3/Advent-Of-Cyber-2023-Walkthroughs/assets/57982315/c4fdf429-a397-469a-bc80-b9d7600cb6ac)


Ans: `10.10.185.225`

### 6. How many requests were made on the malicious domain in total?

You can find that in the previous command

Ans: `1581`

### 7. Having retrieved the exfiltrated data, what is the hidden flag?

Use the below command and scroll up, you will find the flag

`grep frostlings.bigbadstash.thm access.log | cut -d ‘ ‘ -f5 | cut -d ‘=’ -f2 | base64 -d`

Ans: THM{a_gift_for_you_awesome_analyst!}



